{"version":3,"file":"index.js","sources":["../src/classes/Node.ts","../src/classes/NodeMap.ts","../src/classes/EdgeMap.ts","../src/classes/Edge.ts","../src/classes/AdjacencyMap.ts","../src/classes/Graph.ts"],"sourcesContent":["import { ObjectId } from 'bson'\nimport { WithId } from '../interfaces/WithId'\n\nexport class Node<T> implements WithId {\n  public readonly _id: ObjectId\n  private nodeData: T\n  constructor(data: T) {\n    this._id = new ObjectId()\n    this.nodeData = data\n  }\n\n  get id() {\n    return this._id.toHexString()\n  }\n\n  get data() {\n    return this.nodeData\n  }\n\n  set data(data: T) {\n    this.nodeData = data\n  }\n}\n","import { ObjectId } from 'bson'\nimport { Node } from './Node'\n\nexport class NodeMap<ND> {\n  public map: Map<ObjectId, Node<ND>>\n\n  constructor() {\n    this.map = new Map<ObjectId, Node<ND>>()\n  }\n\n  public has = (id: ObjectId) => this.map.has(id)\n  public hasNode = (node: Node<ND>) => this.has(node._id)\n\n  public add = (id: ObjectId, node: Node<ND>) => this.map.set(id, node)\n  public addNode = (node: Node<ND>) => !this.hasNode(node) && this.add(node._id, node)\n\n  public getNodeById = (id: ObjectId) => this.map.get(id)\n\n  public values = () => this.map.values()\n  public entries = () => this.map.entries()\n  public clear = () => this.map.clear()\n\n  public get size() {\n    return this.map.size\n  }\n}\n","import { ObjectId } from 'bson'\nimport { Edge } from './Edge'\nimport { Node } from './Node'\nimport { WithWeight } from '../interfaces/WithWeight'\nimport * as _ from 'lodash'\nexport class EdgeMap<ND, ED extends WithWeight> {\n  private map: Map<ObjectId, Edge<ND, ED>> = new Map()\n\n  constructor(edge?: Edge<ND, ED>) {\n    this.map = edge ? new Map<ObjectId, Edge<ND, ED>>([[edge._id, edge]]) : new Map<ObjectId, Edge<ND, ED>>()\n  }\n  get size() {\n    return this.map.size\n  }\n  get length() {\n    return this.map.size\n  }\n  public clear = () => this.map.clear()\n  public entries = () => this.map.entries()\n  public get = (id: ObjectId) => this.map.get(id)\n  public getEdge = ({ _id }: Edge<ND, ED>) => this.get(_id)\n  public has = (id: ObjectId) => this.map.has(id)\n  public hasEdge = ({ _id }: Edge<ND, ED>) => this.has(_id)\n  public forEach = (\n    callbackFn: (value: Edge<ND, ED>, key: ObjectId, map: Map<ObjectId, Edge<ND, ED>>) => void,\n    thisArg?: any\n  ) => this.map.forEach(callbackFn, thisArg)\n  public values = () => this.map.values()\n  public set = (key: ObjectId, value: Edge<ND, ED>) => this.map.set(key, value)\n  public setEdge = (edge: Edge<ND, ED>) => this.set(edge._id, edge)\n\n  public getEdgesByTargetNodeId = (id: ObjectId) =>\n    new Set<Edge<ND, ED>>(_.filter(Object.fromEntries(this.map), (edge: Edge<ND, ED>) => edge.nodeId.equals(id)))\n\n  public removeEdgesByTargetNodeId = (id: ObjectId) => this.removeEdges(this.getEdgesByTargetNodeId(id))\n\n  public removeEdges = (edges: Set<Edge<ND, ED>>) => edges.forEach(({ _id }: Edge<ND, ED>) => this.removeEdgeById(_id))\n  public removeEdgeById = (id: ObjectId) => this.map.delete(id)\n\n  public hasEdgeToTargetNodeId = (id: ObjectId) => this.getEdgesByTargetNodeId(id).size > 0\n  public hasEdgeToTargetNode = ({ _id }: Node<ND>) => this.hasEdgeToTargetNodeId(_id)\n}\n","import { ObjectId } from 'bson'\nimport { WithId } from '../interfaces/WithId'\nimport { WithWeight } from '../interfaces/WithWeight'\nimport { Node } from './Node'\n\nexport class Edge<N, D extends WithWeight> implements WithId {\n  public readonly _id: ObjectId\n  public edgeData: D\n  public targetNode: Node<N>\n\n  constructor(node: Node<N>, data: D) {\n    this._id = new ObjectId()\n    this.edgeData = data\n    this.targetNode = node\n  }\n\n  get id() {\n    return this._id.toHexString()\n  }\n\n  get data() {\n    return this.edgeData\n  }\n\n  set data(data: D) {\n    this.edgeData = data\n  }\n\n  get node() {\n    return this.targetNode\n  }\n\n  get nodeId() {\n    return this.targetNode._id\n  }\n\n  get weight() {\n    return this.edgeData.weight\n  }\n\n  set weight(weight: number) {\n    this.edgeData.weight = weight\n  }\n}\n","import { ObjectId } from 'bson'\nimport { EdgeMap } from './EdgeMap'\nimport { Node } from './Node'\nimport { WithWeight } from '../interfaces/WithWeight'\nimport { Edge } from './Edge'\n\nexport class AdjacencyMap<ND, ED extends WithWeight> {\n  public map: Map<ObjectId, EdgeMap<ND, ED>>\n\n  constructor(nodeMap: Map<ObjectId, Node<ND>> = new Map<ObjectId, Node<ND>>()) {\n    this.map = new Map<ObjectId, EdgeMap<ND, ED>>()\n    nodeMap.forEach(this.addNode)\n  }\n\n  public has = (id: ObjectId) => this.map.has(id)\n  public hasNode = (node: Node<ND>) => this.has(node._id)\n  public addNode = (node: Node<ND>) => !this.hasNode(node) && this.map.set(node._id, new EdgeMap<ND, ED>())\n\n  public hasEdge = (source: Node<ND>, target: Node<ND>) =>\n    this.hasNode(source) && this.map.get(source._id).hasEdgeToTargetNode(target)\n\n  public addEdge = (source: Node<ND>, target: Node<ND>, edgeData: ED) => this.addBiEdge(source, target, edgeData)\n  public addBiEdge = (source: Node<ND>, target: Node<ND>, edgeData: ED) =>\n    this.addDiEdge(source, target, edgeData) && this.addDiEdge(target, source, edgeData)\n  public addDiEdge = (source: Node<ND>, target: Node<ND>, edgeData: ED) =>\n    this.createMissingNodes(source, target) && this.map.get(source._id).setEdge(new Edge(target, edgeData))\n\n  private createMissingNodes = (source: Node<ND>, target: Node<ND>) =>\n    this.hasSourceAndTarget(source._id, target._id) || this.addMissingNodes(source, target)\n\n  private addMissingNodes = (source: Node<ND>, target: Node<ND>) => {\n    !this.has(source._id) && this.addNode(source)\n    !this.has(target._id) && this.addNode(target)\n  }\n\n  private hasSourceAndTarget = (source: ObjectId, target: ObjectId) => this.has(source) && this.has(target)\n\n  public getEdgeMap = (id: ObjectId) => this.map.get(id)\n  public getEdgeMapByNode = (node: Node<ND>) => this.getEdgeMap(node._id)\n\n  public values = () => this.map.values()\n  public entries = () => this.map.entries()\n  public clear = () => this.map.clear()\n\n  public removeNode = ({ _id }: Node<ND>) => this.removeNodeById(_id)\n  public removeNodeById = (id: ObjectId) =>\n    this.has(id) && this.map.delete(id) && this.map.forEach(edgeMap => edgeMap.removeEdgesByTargetNodeId(id))\n\n  get size() {\n    return this.map.size\n  }\n}\n","import { ObjectId } from 'bson'\nimport { Edge } from './Edge'\nimport { Node } from './Node'\nimport { EdgeMap } from './EdgeMap'\nimport { WithId } from '../interfaces/WithId'\nimport { WithWeight } from '../interfaces/WithWeight'\nimport { NodeMap } from './NodeMap'\nimport { AdjacencyMap } from './AdjacencyMap'\nexport class Graph<GD, ND, ED extends WithWeight> implements WithId {\n  readonly _id: ObjectId\n  public nodeMap: NodeMap<ND>\n  public adjacencyMap: AdjacencyMap<ND, ED>\n  public metaData: GD\n\n  constructor(metaData?: GD) {\n    this._id = new ObjectId()\n    this.nodeMap = new NodeMap<ND>()\n    this.adjacencyMap = new AdjacencyMap<ND, ED>()\n    this.metaData = metaData\n  }\n\n  public addNode = (node: Node<ND>) => {\n    this.nodeMap.addNode(node)\n    this.adjacencyMap.addNode(node)\n    return node\n  }\n\n  public addNodes = (nodes: Array<Node<ND>>) => nodes.forEach(node => this.addNode(node))\n\n  public addNewNode = (nodeData: ND) => this.addNode(new Node(nodeData))\n\n  public addEdge = (source: Node<ND>, target: Node<ND>, edgeData: ED) =>\n    this.createMissingNodes(source, target) && this.adjacencyMap.addEdge(source, target, edgeData)\n\n  public addBiEdge = (source: Node<ND>, target: Node<ND>, edgeData: ED) => this.addEdge(source, target, edgeData)\n\n  public addDiEdge = (source: Node<ND>, target: Node<ND>, edgeData: ED) =>\n    this.createMissingNodes(source, target) && this.adjacencyMap.addDiEdge(source, target, edgeData)\n\n  private createMissingNodes = (source: Node<ND>, target: Node<ND>) =>\n    this.hasSourceAndTargetNodes(source, target) || this.addMissingNodes(source, target)\n\n  private addMissingNodes = (source: Node<ND>, target: Node<ND>) => {\n    !this.hasNode(source) && this.addNode(source)\n    !this.hasNode(target) && this.addNode(target)\n  }\n  private hasSourceAndTargetNodes = (source: Node<ND>, target: Node<ND>) => this.hasNode(source) && this.hasNode(target)\n  public hasNode = (node: Node<ND>) => this.nodeMap.hasNode(node)\n\n  get nodes() {\n    return this.nodeMap.entries()\n  }\n\n  get nodeValues() {\n    return this.nodeMap.values()\n  }\n\n  get size() {\n    return this.nodeMap.size\n  }\n\n  get edgeCount() {\n    return this.adjacencyMap.size\n  }\n\n  getNodeById(id: ObjectId) {\n    return this.nodeMap.getNodeById(id)\n  }\n}\n"],"names":["Node","data","_id","nodeData","ObjectId","this","toHexString","NodeMap","map","has","id","_this","hasNode","node","add","set","addNode","getNodeById","get","values","entries","clear","Map","size","EdgeMap","edge","getEdge","hasEdge","forEach","callbackFn","thisArg","key","value","setEdge","getEdgesByTargetNodeId","Set","_","Object","fromEntries","nodeId","equals","removeEdgesByTargetNodeId","removeEdges","edges","removeEdgeById","delete","hasEdgeToTargetNodeId","hasEdgeToTargetNode","Edge","edgeData","targetNode","weight","AdjacencyMap","nodeMap","source","target","addEdge","addBiEdge","addDiEdge","createMissingNodes","hasSourceAndTarget","addMissingNodes","getEdgeMap","getEdgeMapByNode","removeNode","removeNodeById","edgeMap","Graph","metaData","adjacencyMap","addNodes","nodes","addNewNode","hasSourceAndTargetNodes"],"mappings":"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"}